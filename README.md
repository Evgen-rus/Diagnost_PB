# ü§ñ –î–∏–∞–≥–Ω–æ—Å—Ç –ü–ë - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è

![Python](https://img.shields.io/badge/python-3.10+-blue.svg)
![Telegram](https://img.shields.io/badge/telegram-bot-blue.svg)
![OpenAI](https://img.shields.io/badge/openai-gpt--4.1--mini-green.svg)
![FAISS](https://img.shields.io/badge/faiss-vector--search-orange.svg)
![SQLite](https://img.shields.io/badge/sqlite-database-lightgrey.svg)

**–î–∏–∞–≥–Ω–æ—Å—Ç –ü–ë** ‚Äî —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –≤ –æ–±–ª–∞—Å—Ç–∏ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è, –æ—Å–Ω–∞—â–µ–Ω–Ω—ã–π –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π –∏–∑ 2306 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π.

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### üîç –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –≤ –æ–±–ª–∞—Å—Ç–∏ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.

### üåü –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üß† –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫**: FAISS + FTS5 + SQLite –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏ —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **üìö –ë–æ–≥–∞—Ç–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π**: 2306 —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –∏–∑ 80 –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–ì–û–°–¢—ã, –°–¢–û, –ú–†, –û–°–¢)
- **üìä –°–∏—Å—Ç–µ–º–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: –£–∫–∞–∑–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- **üîÑ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–µ—Ç—Ä–∏–∫

### üî¨ –ú–µ—Ç–æ–¥—ã –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –ø–æ –≤—Å–µ–º –æ—Å–Ω–æ–≤–Ω—ã–º –º–µ—Ç–æ–¥–∞–º –ù–ö:

- **–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–£–ö)** - –¥–µ—Ñ–µ–∫—Ç–æ—Å–∫–æ–ø–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ –∏ —Å–≤–∞—Ä–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–†–∞–¥–∏–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–†–ö)** - –ø—Ä–æ—Å–≤–µ—á–∏–≤–∞–Ω–∏–µ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–º –∏ –≥–∞–º–º–∞-–ª—É—á–∞–º–∏
- **–ú–∞–≥–Ω–∏—Ç–Ω–æ-–ø–æ—Ä–æ—à–∫–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–ú–ü–ö)** - –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤
- **–ö–∞–ø–∏–ª–ª—è—Ä–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–ü–í–ö)** - –∫–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ–Ω–∏–∫–∞—é—â–∏–º–∏ –≤–µ—â–µ—Å—Ç–≤–∞–º–∏
- **–í–∏—Ö—Ä–µ—Ç–æ–∫–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–í–¢–ö)** - –∫–æ–Ω—Ç—Ä–æ–ª—å —ç–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤–æ–¥—è—â–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- **–ê–∫—É—Å—Ç–∏–∫–æ-—ç–º–∏—Å—Å–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–ê–≠–ö)** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–≤–∏—Ç–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤
- **–¢–µ–ø–ª–æ–≤–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–¢–ö)** - –∏–Ω—Ñ—Ä–∞–∫—Ä–∞—Å–Ω–∞—è —Ç–µ—Ä–º–æ–≥—Ä–∞—Ñ–∏—è
- **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏ –∏–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–í–ò–ö)** - –æ—Å–º–æ—Ç—Ä –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Diagnost_PB/
‚îú‚îÄ‚îÄ ü§ñ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                          # Telegram-–±–æ—Ç —Å FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ prompts.py                      # –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –ù–ö
‚îÇ   ‚îî‚îÄ‚îÄ config.py                       # –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ üîç –ì–∏–±—Ä–∏–¥–Ω—ã–π –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ load_excel_to_vectordb.py       # –ó–∞–≥—Ä—É–∑–∫–∞ Excel ‚Üí SQLite
‚îÇ   ‚îú‚îÄ‚îÄ build_faiss_index.py            # –°–æ–∑–¥–∞–Ω–∏–µ FAISS –∏–Ω–¥–µ–∫—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ build_fts_index.py              # –°–æ–∑–¥–∞–Ω–∏–µ FTS5 –∏–Ω–¥–µ–∫—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ database_v1.xlsx                # –ò—Å—Ö–æ–¥–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
‚îÇ

‚îÇ
‚îú‚îÄ‚îÄ üõ†Ô∏è –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ vector_search.py            # –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ FAISS
‚îÇ       ‚îú‚îÄ‚îÄ fts_search.py               # –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ FTS5
‚îÇ       ‚îú‚îÄ‚îÄ hybrid_search.py            # –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (FAISS + FTS5)
‚îÇ       ‚îú‚îÄ‚îÄ database.py                 # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îÇ       ‚îú‚îÄ‚îÄ logger.py                   # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ token_counter.py            # –ü–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ OpenAI
‚îÇ       ‚îú‚îÄ‚îÄ session_cleaner.py          # –û—á–∏—Å—Ç–∫–∞ —Å–µ—Å—Å–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ exceptions.py               # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
‚îÇ
‚îú‚îÄ‚îÄ üìÅ –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ data/                           # –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faiss_index.bin             # FAISS –∏–Ω–¥–µ–∫—Å (14.2 –ú–ë)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ vector_map.json             # –ú–∞–ø–ø–∏–Ω–≥ ID (44.9 –ö–ë)
‚îÇ   ‚îú‚îÄ‚îÄ logs/                           # –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ knowledge_base_v2.db            # SQLite –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
‚îÇ
‚îú‚îÄ‚îÄ üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
    ‚îî‚îÄ‚îÄ check_db.py                     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```

## üîÑ –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫: FAISS + SQLite + FTS5

### üìã –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

**–¢—Ä–µ—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥** –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç—Ä–µ—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π:

- **FAISS** - –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤
- **FTS5** - –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **SQLite** - –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∏ –±–æ–≥–∞—Ç—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

```python
# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:
FAISS:     [0.123, -0.456, ...]  # –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ - –ë–´–°–¢–†–û!
FTS5:      "—Ç–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã"       # –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ - –¢–û–ß–ù–û!
SQLite:    "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç..."      # –ë–æ–≥–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ - –ì–ò–ë–ö–û!
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚ö° **–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫**: FAISS –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏–∫–∏, FTS5 –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
- üéØ **–¢–æ—á–Ω–æ—Å—Ç—å**: FTS5 –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤ –∏ —Ñ—Ä–∞–∑
- üíæ **–≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏**: –≤–µ–∫—Ç–æ—Ä—ã –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç —Ç–µ–∫—Å—Ç–æ–≤
- üîß **–ì–∏–±–∫–æ—Å—Ç—å SQL**: —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã
- üìä **–ë–æ–≥–∞—Ç—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**: –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

### üîç –ü—Ä–æ—Ü–µ—Å—Å –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

```mermaid
graph LR
    A[–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è] --> B[–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ FAISS]
    A --> C[FTS5 –ø–æ–∏—Å–∫]
    B --> D[–¢–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞]
    C --> E[–¢–æ–ø-3 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞]
    D --> F[–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –±–µ–∑ –¥—É–±–ª–µ–π]
    E --> F
    F --> G[–î–æ 6 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    G --> H[–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è GPT]
```

### üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –ø–æ–∏—Å–∫–∞

| –¢–∏–ø –ø–æ–∏—Å–∫–∞ | –õ—É—á—à–µ –¥–ª—è | –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ |
|------------|-----------|----------------|
| **–í–µ–∫—Ç–æ—Ä–Ω—ã–π (FAISS)** | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ | "–ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–¥—Ü–µ–º" |
| **FTS5** | –¢–æ—á–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã | "–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è", "–ì–û–°–¢-123" |
| **–ì–∏–±—Ä–∏–¥–Ω—ã–π** | –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π | "–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏–∏" |

### üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FTS5

#### –°–æ–∑–¥–∞–Ω–∏–µ FTS –∏–Ω–¥–µ–∫—Å–∞:
```bash
python build_fts_index.py
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config.py`:
```python
# FTS search configuration
FTS_ENABLED = True                    # –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ FTS –ø–æ–∏—Å–∫–∞
FTS_DEFAULT_LIMIT = 3                # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ FTS –ø–æ–∏—Å–∫–∞
HYBRID_SEARCH_ENABLED = True         # –í–∫–ª—é—á–µ–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
```

### üîç –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ (–ø–æ—à–∞–≥–æ–≤–æ)

#### –®–∞–≥ 1: üéØ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫
```python
# –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ FAISS
vector_results = vector_search(query_embedding, top_k=3)

# FTS –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ SQLite FTS5
fts_results = fts_search(query, limit=3)
```

#### –®–∞–≥ 2: üîÑ –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
# –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–∑ –¥—É–±–ª–µ–π
merged_results = merge_search_results(vector_results, fts_results)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥–æ 6 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —á–∞–Ω–∫–æ–≤
```

#### –®–∞–≥ 3: üìö –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```python
# –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è GPT –∏–∑ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
context = create_context_for_gpt(merged_results)
```


## üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

- **üìÑ 2306 —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤** –∏–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **üìö 80 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (–ì–û–°–¢—ã, –°–¢–û, –ú–†, –û–°–¢, –ª–µ–∫—Ü–∏–∏)
- **üè∑Ô∏è 13 —Ç–∏–ø–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –º–µ—Ç–æ–¥–∞–º –ù–ö
- **üîç –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenAI Embeddings text-embedding-3-small
- **‚ö° FAISS –∏–Ω–¥–µ–∫—Å** –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

#### SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (knowledge_base_v2.db)
```sql
CREATE TABLE chunks (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    chunk_id TEXT UNIQUE NOT NULL,
    document_id INTEGER,
    doc_type_short TEXT,
    doc_type_full TEXT,
    doc_number TEXT,
    file_name TEXT,
    chunk_index INTEGER,
    chunk_text TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### FAISS –∏–Ω–¥–µ–∫—Å (data/faiss_index.bin)
- **–†–∞–∑–º–µ—Ä**: 14.2 –ú–ë
- **–í–µ–∫—Ç–æ—Ä—ã**: 2306 √ó 1536 —á–∏—Å–µ–ª
- **–ú–æ–¥–µ–ª—å**: OpenAI text-embedding-3-small

#### –ú–∞–ø–ø–∏–Ω–≥ ID (data/vector_map.json)
- **–†–∞–∑–º–µ—Ä**: 44.9 –ö–ë
- **–§–æ—Ä–º–∞—Ç**: `{"faiss_id": "chunk_id"}`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–≤—è–∑—å –º–µ–∂–¥—É FAISS –∏–Ω–¥–µ–∫—Å–æ–º –∏ SQLite

### üè∑Ô∏è –¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

- **–ì–û–°–¢** - –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –†–§
- **–°–¢–û** - –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π (–ì–∞–∑–ø—Ä–æ–º, –†–æ—Å–Ω–µ—Ñ—Ç—å)
- **–ú–†** - –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- **–û–°–¢** - –û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã
- **–†–î** - –†—É–∫–æ–≤–æ–¥—è—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- **–õ–µ–∫—Ü–∏–∏** - –£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –º–µ—Ç–æ–¥–∞–º –ù–ö

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python 3.10+** –∏–ª–∏ –≤—ã—à–µ
- **Telegram Bot Token** (–ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather))
- **OpenAI API –∫–ª—é—á** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å AI –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
- **2-4 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/Evgen-rus/Diagnost_PB.git /opt/diagnost_pb
# –∏–ª–∏
git clone https://github.com/Evgen-rus/Diagnost_PB.git .
```

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
# Linux/MacOS:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p logs data

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp .env.example .env
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nano .env
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `.env`:

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather

# OpenAI API
OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_api_openai
OPENAI_MODEL=gpt-4o

# Logging
LOG_LEVEL=INFO
ENABLE_DIALOG_LOGGING=true
```

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel –≤ SQLite
python load_excel_to_vectordb.py

# 2. –°–æ–∑–¥–∞–Ω–∏–µ FAISS –∏–Ω–¥–µ–∫—Å–∞ (—Ç—Ä–µ–±—É–µ—Ç OPENAI_API_KEY)
python build_faiss_index.py

# 3. –°–æ–∑–¥–∞–Ω–∏–µ FTS5 –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
python build_fts_index.py

```

### üêß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞ (Linux)

#### –°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–ª—É–∂–±—ã

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å–ª—É–∂–±—ã
sudo nano /etc/systemd/system/diagnost-pb-bot.service
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ —Å–ª—É–∂–±—ã:

```ini
[Unit]
Description=Diagnost PB Bot
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/diagnost_pb
Environment=PATH=/opt/diagnost_pb/venv/bin:$PATH
ExecStart=/opt/diagnost_pb/venv/bin/python bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ systemd
systemctl daemon-reload

# –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
systemctl enable diagnost-pb-bot

# –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã
systemctl start diagnost-pb-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
systemctl status diagnost-pb-bot
```

### üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
journalctl -u diagnost-pb-bot -f

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
journalctl -u diagnost-pb-bot -n 100

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
systemctl restart diagnost-pb-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
systemctl stop diagnost-pb-bot

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
systemctl disable diagnost-pb-bot
```

### üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –±–æ—Ç–∞
cd /opt/diagnost_pb

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
systemctl stop diagnost-pb-bot

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
git pull

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
systemctl start diagnost-pb-bot
```

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### üéÆ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ó–∞–ø—É—Å–∫ –¥–∏–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º
- `/cancel` - –ü—Ä–µ—Ä–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### üîç –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–û–±—ä—è—Å–Ω–∏** - —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º—ã
- **–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å** - —Å–±—Ä–æ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞
- **–ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### üí¨ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–æ—Ç—É:

```
‚ùì "–ö–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç?"
‚ùì "–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ø–ø–∞—Ä–∞—Ç –¥–ª—è –º–∞–≥–Ω–∏—Ç–Ω–æ-–ø–æ—Ä–æ—à–∫–æ–≤–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è?"
‚ùì "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ì–û–°–¢ –∫ —Ä–∞–¥–∏–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é —Å–≤–∞—Ä–Ω—ã—Ö —à–≤–æ–≤"
‚ùì "–ö–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–ø–∏–ª–ª—è—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è?"
‚ùì "–ö–∞–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω—É–∂–Ω–æ –¥–ª—è –∞–∫—É—Å—Ç–∏–∫–æ-—ç–º–∏—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è?"
```

#### –û—Ç–≤–µ—Ç—ã —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏:

–ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:
- **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (–ì–û–°–¢, –°–¢–û, –ú–†)
- **–†–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞** (0.0-1.0)
- **–ù–æ–º–µ—Ä–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤** –∏ –ø—É–Ω–∫—Ç–æ–≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–æ–≤
- **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π** –æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–æ–≤

### üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
python check_db.py
```

#### –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
```bash
python analyze_database.py
```

### üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

–ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **–°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã**: `systemctl status diagnost-pb-bot`
2. **–õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞**: `journalctl -u diagnost-pb-bot -n 100`
3. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤** –≤ —Ñ–∞–π–ª–µ `.env`
4. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API OpenAI** (–≤–æ–∑–º–æ–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω—É)
5. **–ù–∞–ª–∏—á–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞**: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `data/`


## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üìã –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```env
# Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ @BotFather)
TELEGRAM_BOT_TOKEN=your_bot_token_here

# OpenAI API Key (–¥–ª—è AI –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞)
OPENAI_API_KEY=your_openai_api_key_here
```

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```env
# –ú–æ–¥–µ–ª—å OpenAI (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: gpt-4.1-mini)
OPENAI_MODEL=gpt-4o

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# –í–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
ENABLE_DIALOG_LOGGING=true

# FTS –ø–æ–∏—Å–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤–∫–ª—é—á–µ–Ω)
FTS_ENABLED=true

# –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤–∫–ª—é—á–µ–Ω)
HYBRID_SEARCH_ENABLED=true
```

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config.py`
```python
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞–Ω–∫–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
DEFAULT_TOP_K = 3

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
MAX_CONTEXT_TOKENS = 1000

# –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ OpenAI text-embedding-3-small
EMBEDDING_DIMENSION = 1536
```

### üóÉÔ∏è –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö

#### –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **`knowledge_base_v2.db`** - SQLite –±–∞–∑–∞ —Å —Ç–µ–∫—Å—Ç–∞–º–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **`data/faiss_index.bin`** - FAISS –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **`data/vector_map.json`** - –ú–∞–ø–ø–∏–Ω–≥ –º–µ–∂–¥—É FAISS –∏ SQLite ID

#### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **`database_v1.xlsx`** - –ò—Å—Ö–æ–¥–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∏–∑ 2306 —á–∞–Ω–∫–æ–≤
- **`logs/`** - –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –ª–æ–≥–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### ü§ñ AI –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ

- **OpenAI API**: GPT-–º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- **FAISS**: Meta's –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **OpenAI Embeddings**: text-embedding-3-small –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤
- **RAG**: Retrieval-Augmented Generation –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### üîß Backend –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- **Python 3.10+**: –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **aiogram 3.17.0**: —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram-–±–æ—Ç–æ–≤
- **SQLite**: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤, –ª–æ–≥–æ–≤ –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã
- **SQLite FTS5**: –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
- **pandas, numpy**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- **tiktoken**: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤


## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### üîÑ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ù–ö
1. –û–±–Ω–æ–≤–∏—Ç–µ `prompts.py` —Å –Ω–æ–≤—ã–º–∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
2. –î–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ `database_v1.xlsx`
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å: `python build_faiss_index.py`

#### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ `load_excel_to_vectordb.py` –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ `utils/database.py`
3. –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ `utils/vector_search.py` –ø–æ–¥ –Ω–æ–≤—ã–µ –ø–æ–ª—è
4. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ FTS –∏–Ω–¥–µ–∫—Å: `python build_fts_index.py`

